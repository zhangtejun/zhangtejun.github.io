---
layout: post
title:  "jvm指令与工具jstat/jstack/jmap/jconsole/jps/visualVM"
date:   2019-10-16 10:13:34
author: zhangtejun
categories: Java
---
##### jps
* 显示当前所有java进程pid的命令
```
# 1. 参数 -v 可以显示传递给 Java 虚拟机的参数。
jps -v

# 2. 不带参数，默认显示 进程ID 和 启动类的名称。
jps
```

* 查看远程服务器 jps 信息
jps 支持查看远程服务上的 jvm 进程信息。如果需要查看其他机器上的 jvm 进程，需要在待查看机器上启动 jstatd 服务。

* jps 原理
java程序在启动以后，会在java.io.tmpdir指定的目录下，就是临时文件夹里，生成一个类似于hsperfdata_User的文件夹，
这个文件夹里（在Linux中为/tmp/hsperfdata_{userName}/），有几个文件，名字就是java进程的pid，因此列出当前运行的java进程，只是把这个目录里的文件名列一下而已。


##### jconsole
用于连接正在运行的本地或者远程的JVM，对运行在java应用程序的资源消耗和性能进行监控，提供强大的可视化界面。

##### jstat
jstat命令可以查看堆内存各部分的使用量，以及加载类的数量。
```
# 1. 参数 -gcutil 每time毫秒时间打印一次，百分比显示
jstat -gcutil pid time

# 2. 直接显示
jstat -gc pid

# 3. 至查看young区
jstat -gcnew pid

# 4. 至查看old区
jstat -gcold pid
```

##### jstack(分析线程)
可以查看或导出 java 应用程序中线程堆栈信息.
```
jstack pid

```

##### jmap
可以生成 java 程序的 dump 文件， 也可以查看堆内对象示例的统计信息、查看 ClassLoader 的信息以及 finalizer 队列。
```
# 以hprof二进制格式转储Java堆到指定filename的文件中
jmap -dump:format=b,file=heapdump.phrof pid

jmap -dump:file=heapdump.phrof pid

# 显示Java堆详细信息,包括使用的GC算法、堆配置信息和各内存区域内存使用信息
jmap -heap pid
```


